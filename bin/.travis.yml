dist: trusty

language:
    - php
php:
    - 5.6.4

# env:
#
# - TEST_SUITE=01-Privacy
# - TEST_SUITE=02-Display
# - TEST_SUITE=03-Buddypress
# - TEST_SUITE=04-MediaSizes
# - TEST_SUITE=05-Types
# - TEST_SUITE=06-CustomCss
# - TEST_SUITE=07-OtherSettings

addons:
  browserstack:
    username: rtcamp2
    access_key:
        secure: "PUUus7Qw8OnsgmwKYGu9N812QQCRrZk9ksJWhyFUqLzGhL2hf03HL4g5VB2oiXp3JMFXwjuPyb7Kk26Vc03Re75dEXvSaS/NvPpD1kJ+c4v3VVrGqLIqBWz0398SRgH0ApcsPwYOx8buMAq34JE03zD3186KV6iSztUPYHwMigos+sooZHCOaCG9X5K3O6t3Dbpz0ZY1L/hvnhw/Vc1yTi0VMGazI3B1gFH+a5VWbMhn7EwD12mR81cF0C04WnBrySSa4h84W2gMHULhNROZrYzGRsEKYOfPpzmrMi4pkZyxp9oCxW5y8m7k/uQkHLLHKV4z4EJWIDwIfNsKNznhqva/AfwNwpFrB38J82D6r3ipy0jxPj1LWZEZmOM7RmQJ0Yau3yK0yBRoQWmrmW9GdT/35WGM/jnenHhcWJHy55d1jnSCBGa/vW2cqS2wzkHiingDHrTuRJ5ppUIqz5GTPSwniXAZ7kGzUNZy6wWQGYhRMmHCJd45H9eMDRYS7uLYagp/2xeCSgCa80eLTC7yqJrNIXKrdLnbHwcRl2ix5EoyPu1Tk0Amm5pSkaBzPyIQBtUebQCQrtYMOdPXIEk++c3TWPOyntHa3Jr/wKi7VtWKJTnmdawWm+ayvlk8uo8f/+pVaRb2mI53S1bWuhim9fukeQD8/e4GRnmBC7fEF/Y="

before_install:
- rm -rf ~/.gnupg

cache:
  paths:
  - vendor/

before_script:
- export PLUGIN_DIR=$(pwd)
- sudo rm -rf /etc/mysql/
- sudo apt-get -qq purge mysql* graphviz* && sudo apt-get -qq autoremove
- sudo bash -c 'echo -e "[user]\n\tname = abc\n\temail = root@localhost.com" > /home/travis/.gitconfig'
- wget -qO ee rt.cx/ee && sudo bash ee
- sudo tail /var/log/ee/ee.log
- sudo ee site create test.rtmedia.me --wp --user=ADMINUSER --email=krupa.nanda@rtcamp.com --pass=ADMINPASS
- sudo sed -i '/^127.0.0.1/ s/$/ test.rtmedia.me/' /etc/hosts
- sudo chmod 777 -R /var/www
- cd /var/www/test.rtmedia.me/htdocs/wp-content/plugins/ && mkdir rtMedia
- cd $PLUGIN_DIR
- cp -Rf * /var/www/test.rtmedia.me/htdocs/wp-content/plugins/rtMedia/
- cd /var/www/test.rtmedia.me/htdocs/
- wp --allow-root plugin install https://downloads.wordpress.org/plugin/buddypress.2.8.2.zip
- wp plugin activate --all
- cd /var/www/test.rtmedia.me/htdocs/wp-content/themes/
- wp theme activate twentysixteen
- cd $PLUGIN_DIR
- cd tests/codeception/tests/_data
- git clone --depth=1 https://github.com/rtCamp/rtmedia-test-data.git test-data
- cd /tmp
- wget http://www.browserstack.com/browserstack-local/BrowserStackLocal-linux-x64.zip
- unzip BrowserStackLocal-linux-x64.zip
- nohup ./BrowserStackLocal --key $BROWSERSTACK_ACCESS_KEY &
- cd $PLUGIN_DIR/tests/codeception/
- composer install
- export PATH="$PATH:/home/travis/build/kjnanda/rtMedia/tests/codeception/vendor/bin"

script:

# - if [ "$TEST_SUITE" = "01-Privacy" ]; then wpcept run tests/acceptance/core-rtMedia-settings/01-Privacy/; fi
#
# - if [ "$TEST_SUITE" = "02-Display" ]; then wpcept run tests/acceptance/core-rtMedia-settings/02-Display/; fi
#
# - if [ "$TEST_SUITE" = "03-Buddypress" ]; then wpcept run tests/acceptance/core-rtMedia-settings/03-Buddypress/; fi
#
# - if [ "$TEST_SUITE" = "04-MediaSizes" ]; then wpcept run tests/acceptance/core-rtMedia-settings/04-MediaSizes/; fi
#
# - if [ "$TEST_SUITE" = "05-Types" ]; then wpcept run tests/acceptance/core-rtMedia-settings/05-Types/; fi
#
# - if [ "$TEST_SUITE" = "06-CustomCss" ]; then wpcept run tests/acceptance/core-rtMedia-settings/06-CustomCss/; fi
#
# - if [ "$TEST_SUITE" = "07-OtherSettings" ]; then wpcept run tests/acceptance/core-rtMedia-settings/07-OtherSettings/; fi

- wpcept run tests/acceptance/core-rtMedia-settings/01-Privacy/
- wpcept run tests/acceptance/core-rtMedia-settings/02-Display/
- wpcept run tests/acceptance/core-rtMedia-settings/03-Buddypress/
- wpcept run tests/acceptance/core-rtMedia-settings/04-MediaSizes/
- wpcept run tests/acceptance/core-rtMedia-settings/05-Types/
