dist: trusty

language:
    - php

branches:
  only:
    - codeception
php:
    - 5.6.4
#    - 7.0

addons:
  browserstack:
    username: "rtcamp2"
    access_key:
       secure: "sz3FPbhCQHj3/VaLssdGPcgClyR6kpvOTcNogWAiT852VW852+jlRoKRFGHSSS6pnsEQ8FB+dYsfSLGA3yvaXAYkmElfXxJEc5A/I1rdklL24y2WbsyJRRg4VnCITNOLLxLwkp0KJd+2ZJ2bLQdT5ZsWqsIxIWTrYrMS2pJXsWxcZ8eylFj3IULbJ+vHynw6Z65DPSKYsr9CQvxdGYcErCISHco9q7UmNWRi/1k4l5cJmk9ri/v4/j2DlvPHUMO0WKOUU0CEO9eGAE0l4iLmXlGUmviriE1PcD2aFci0olFn4aAIHesZI7p8Teh0R7ByTbsqJrQJ1KikLqF2pFFPMTkh3y70+FvJ9LtR4+YubCY464+0/RlTaPCu62c1EmKns3DOLqeEezwIFiuS+YoXWZUkNx7vAZHPC5ksG4+0ph5rVqBYtBVY5cApzkQBJiky6ZvmOzdfsrT6llXkQEAyIdvE19nUkb0JKz1LA28bJXiU/b0QWWplwe32NROjnpnOOS8pd8zY0QUS8xBi8hzO966R9St8XDBcMdvv0wedw+QEI4vinpZ457rEfG4NyzipZctFvB3mlXHb5t0LFonVc0kmhfAQ0Y8kkk4zrEwf19OU2i70SwQIEzkSsw+BwEyY65I/xSFuB2zS0A3kd58wg4wUZ3pYK5hW9mcE32WPzEY="





before_install:
- rm -rf ~/.gnupg


cache:
  paths:
  - vendor/

before_script:
- export PLUGIN_DIR=$(pwd)
- sudo rm -rf /etc/mysql/
- sudo apt-get -qq purge mysql* graphviz* && sudo apt-get -qq autoremove
- sudo bash -c 'echo -e "[user]\n\tname = abc\n\temail = root@localhost.com" > /home/travis/.gitconfig'
- wget -qO ee rt.cx/ee && sudo bash ee
- sudo apt-get update
- sudo tail /var/log/ee/ee.log
- sudo ee site create sumeet.rtmedia.me --wp --user=ADMINUSER --email=sumeet.sarna@rtcamp.com --pass=ADMINPASS
- sudo sed -i '/^127.0.0.1/ s/$/ sumeet.rtmedia.me/' /etc/hosts
- sudo chmod 777 -R /var/www
- cd /var/www/sumeet.rtmedia.me/htdocs/wp-content/plugins/ && mkdir rtMedia
- cd $PLUGIN_DIR
- cp -Rf * /var/www/sumeet.rtmedia.me/htdocs/wp-content/plugins/rtMedia/
- cd /var/www/sumeet.rtmedia.me/htdocs/
- wp --allow-root plugin install https://downloads.wordpress.org/plugin/buddypress.2.8.2.zip
- wp plugin activate --all
- cd /var/www/sumeet.rtmedia.me/htdocs/wp-content/themes/
- wp theme activate twentysixteen
- cd $PLUGIN_DIR
- cd tests/codeception/tests/_data
- git clone --depth=1 https://github.com/rtCamp/rtmedia-test-data.git test-data
- cd /tmp
- wget http://www.browserstack.com/browserstack-local/BrowserStackLocal-linux-x64.zip
- unzip BrowserStackLocal-linux-x64.zip
- nohup ./BrowserStackLocal --key $BROWSERSTACK_ACCESS_KEY &
- cd $PLUGIN_DIR/tests/codeception/
- composer update
#- export PATH="$PATH:/home/travis/build/sumeetsarna/rtMedia/tests/codeception/vendor/bin"

script:
- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/02-Display/01-Positive/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/02-Display/02-Negative/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/01-Types/01-Negative/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/01-Types/02-Positive/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/03-Buddypress/01-Positive/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/03-Buddypress/02-Negative/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/04-MediaSizes/01-Postive/  --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/04-MediaSizes/02-Negative/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/05-Privacy/01-Positive/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/05-Privacy/02-Negative/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/06-CustomCss/01-Positive/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/06-CustomCss/02-Negative/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/07-OtherSettings/01-Positive/ --steps
#- vendor/bin/wpcept run tests/acceptance/core-rtMedia-settings/07-OtherSettings/02-Negative/ --steps
