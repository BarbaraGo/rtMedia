dist: trusty
language:
    - php

php:
    - 5.6.4

addons:
  browserstack:
    username: "rtcamp2"
    access_key:
      secure: "fwxPQanBIFXUfvm1WfBC3w0cOw7Cx6f4Lz1NH5Hje7W3t8d6Vj7ckaWsJnymBiOv0nch2kvQtVvPhTobyPXH0B6rJXno0/0HhFZVV9UBdrg/IubJzBxHLlTKIHC+jdP0aklp5O4O3/syQZrMmQAhKjHBKzt+KQuqVohbiUpAnSDYN9zApL/TwRc7bVsEhz1rtlZbPs13cBkyVGlngHghs1BuX6dQ8+gfwQ5ueK1tcfI02iVSs7Lp1Zy9NH2fPERdHp9xuiOhKy7enqR4DzPQ/hj0nH+J1eB5zicVSG2vdhamUCu7IQIB5WGbgyfWyaASnwlc2XD/vFVtM7jo+hDBIWicZ+0111aF/AlzVfzy8S1uI2yoysJNCuYiG6L6Gsj8w3bWrtJ0vUYuUv5d9SkLqiSwQ/wTbUkdmezRhIhXdyhrG7N+tsPA1aiyNMWEnNrD+ZHCkEjdMNXXUOgs68TSR46HrVjhat9vsmskuoOVBs2VXiciyBxZgSWhDjrWbORHsAsqe37vdDq14QmeGWvOvJ9qZSa53DFdzbiSdoSWHRHDhRIV7BcomcDdkx9qScYc4Gf+ZC3nYvFAUm2KwbiQKxl5Ck0TDPmlph2ulsxVg/1DNQKo034Dh8E4KriSUjAboIz2JBva1Tla6DyOyl7H1q7JoAU4czOqR/TnpoO5MzY="
before_install:
- rm -rf ~/.gnupg
cache:
  paths:
  - vendor/
before_script:
- export PLUGIN_DIR=$(pwd)
- sudo rm -rf /etc/mysql/
- sudo apt-get -qq purge mysql* graphviz* && sudo apt-get -qq autoremove
- sudo bash -c 'echo -e "[user]\n\tname = abc\n\temail = root@localhost.com" > /home/travis/.gitconfig'
- wget -qO ee rt.cx/ee && sudo bash ee
- sudo tail /var/log/ee/ee.log
- sudo ee site create test.rtmedia.me --wp --user=ADMINUSER --email=krupa.nanda@rtcamp.com
  --pass=ADMINPASS
- sudo sed -i '/^127.0.0.1/ s/$/ test.rtmedia.me/' /etc/hosts
- sudo chmod 777 -R /var/www
- cd /var/www/test.rtmedia.me/htdocs/wp-content/plugins/ && mkdir rtMedia
- cd $PLUGIN_DIR
- cp -Rf * /var/www/test.rtmedia.me/htdocs/wp-content/plugins/rtMedia/
- cd /var/www/test.rtmedia.me/htdocs/
- wp --allow-root plugin install https://downloads.wordpress.org/plugin/buddypress.2.8.2.zip
- wp plugin activate --all
- cd /var/www/test.rtmedia.me/htdocs/wp-content/themes/
- wp theme activate twentysixteen
- cd $PLUGIN_DIR
- cd tests/codeception/tests/_data
- git clone --depth=1 https://github.com/rtCamp/rtmedia-test-data.git test-data
- cd /tmp
- wget http://www.browserstack.com/browserstack-local/BrowserStackLocal-linux-x64.zip
- unzip BrowserStackLocal-linux-x64.zip
- nohup ./BrowserStackLocal --key $BROWSERSTACK_ACCESS_KEY &
- cd $PLUGIN_DIR/tests/codeception/
- composer instal
- pwd
- export PATH="$PATH:/home/travis/build/umeshnevase/rtMedia/tests/codeception/vendor/bin"
script:

- wpcept run acceptance --steps

notifications:
  slack:
    secure: E9tbxOZ/n4Gcwi8SiCKQ5QVw+5AfwdTq4e/VG4epQF74IqXmJJvaJgQSVKLSVXJm4O1u8JHd+ffN1Xheh1FDaKkscuJYQcT4D+oOc40bHhb0tS71v1fAMzMX7NuyqgEu2a8dbYo7bqVKtdj/EBbOPWnwgfMuA6ylTItVf294spA=
